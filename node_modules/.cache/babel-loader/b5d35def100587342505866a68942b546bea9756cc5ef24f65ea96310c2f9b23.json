{"ast":null,"code":"import _slicedToArray from\"/home/mohanned/Downloads/battleship-main/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useContext}from'react';import{SetupWindow,SetupTitle,AxisButton,GridOverlayContainer}from'../styled_components/gameControllerStyles';import ShipPlacementGrid from'./ShipPlacementGrid';import CellSelectorGrid from'./CellSelectorGrid';import shipTypes from'../../game_helpers/shipTypes';import placePlayerShip from'../../game_helpers/placePlayerShip';import placeComputerShips from'../../game_helpers/placeComputerShips';import{store}from'../../GameController';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";function GameSetup(_ref){var dismount=_ref.dismount,setDismount=_ref.setDismount,fadeOutMusic=_ref.fadeOutMusic;var _useContext=useContext(store),state=_useContext.state,dispatch=_useContext.dispatch;var players=state.players;var _useState=useState(0),_useState2=_slicedToArray(_useState,2),currentShip=_useState2[0],setCurrentShip=_useState2[1];var _useState3=useState('x'),_useState4=_slicedToArray(_useState3,2),axis=_useState4[0],setAxis=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];// using a new loading state to avoid race conditions between the render\n// and setDismount. this causes the animation to load incorrectly.\n// this method allows the component to always render with\n// the animation starting from being completely faded\nuseEffect(function(){if(loading){setDismount(false);setLoading(false);}},[setDismount,loading]);var handleAnimationEnd=function handleAnimationEnd(){// allow for the fadeout\nif(dismount){dispatch({type:'SET_TIMELINE',payload:'game start'});}};var handlePlaceShip=function handlePlaceShip(location){var gameBoard=players.human.gameBoard;var locationArray=gameBoard.createLocationArray(location,shipTypes[currentShip],axis);// returns true if there are no collisions\nif(gameBoard.checkCollisions(locationArray)){placePlayerShip({player:players.human,locationArray:locationArray,currentShip:currentShip,dispatch:dispatch});// check if this is the last ship to be placed\nif(currentShip>=4){fadeOutMusic();// Computer will place ships\nplaceComputerShips(dispatch,state.players.computer.gameBoard);setDismount(true);}else{setCurrentShip(currentShip+1);}}};return!loading&&/*#__PURE__*/_jsxs(SetupWindow,{onAnimationEnd:handleAnimationEnd,style:{animation:dismount?'fadeout 2s':'fadein 2s'},children:[/*#__PURE__*/_jsxs(SetupTitle,{children:[players.human.name,\", Place Your \",shipTypes[currentShip].name,\":\"]}),/*#__PURE__*/_jsxs(AxisButton,{onClick:function onClick(){return setAxis(axis==='x'?'y':'x');},children:[\"AXIS: \",axis]}),/*#__PURE__*/_jsxs(GridOverlayContainer,{children:[/*#__PURE__*/_jsx(ShipPlacementGrid,{}),/*#__PURE__*/_jsx(CellSelectorGrid,{currentShip:currentShip,axis:axis,handlePlaceShip:handlePlaceShip})]})]});}export default GameSetup;","map":{"version":3,"names":["React","useState","useEffect","useContext","SetupWindow","SetupTitle","AxisButton","GridOverlayContainer","ShipPlacementGrid","CellSelectorGrid","shipTypes","placePlayerShip","placeComputerShips","store","GameSetup","dismount","setDismount","fadeOutMusic","state","dispatch","players","currentShip","setCurrentShip","axis","setAxis","loading","setLoading","handleAnimationEnd","type","payload","handlePlaceShip","location","gameBoard","human","locationArray","createLocationArray","checkCollisions","player","computer","animation","name"],"sources":["/home/mohanned/Downloads/battleship-main/src/components/game_window/GameSetup.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport {\n\tSetupWindow,\n\tSetupTitle,\n\tAxisButton,\n\tGridOverlayContainer,\n} from '../styled_components/gameControllerStyles';\nimport ShipPlacementGrid from './ShipPlacementGrid';\nimport CellSelectorGrid from './CellSelectorGrid';\nimport shipTypes from '../../game_helpers/shipTypes';\nimport placePlayerShip from '../../game_helpers/placePlayerShip';\nimport placeComputerShips from '../../game_helpers/placeComputerShips';\nimport { store } from '../../GameController';\n\nfunction GameSetup({ dismount, setDismount, fadeOutMusic }) {\n\tconst { state, dispatch } = useContext(store);\n\tconst { players } = state;\n\tconst [currentShip, setCurrentShip] = useState(0);\n\tconst [axis, setAxis] = useState('x');\n\tconst [loading, setLoading] = useState(true);\n\n\t// using a new loading state to avoid race conditions between the render\n\t// and setDismount. this causes the animation to load incorrectly.\n\t// this method allows the component to always render with\n\t// the animation starting from being completely faded\n\tuseEffect(() => {\n\t\tif (loading) {\n\t\t\tsetDismount(false);\n\t\t\tsetLoading(false);\n\t\t}\n\t}, [setDismount, loading]);\n\n\tconst handleAnimationEnd = () => {\n\t\t// allow for the fadeout\n\t\tif (dismount) {\n\t\t\tdispatch({ type: 'SET_TIMELINE', payload: 'game start' });\n\t\t}\n\t};\n\n\tconst handlePlaceShip = (location) => {\n\t\tconst { gameBoard } = players.human;\n\t\tconst locationArray = gameBoard.createLocationArray(\n\t\t\tlocation,\n\t\t\tshipTypes[currentShip],\n\t\t\taxis\n\t\t);\n\t\t// returns true if there are no collisions\n\t\tif (gameBoard.checkCollisions(locationArray)) {\n\t\t\tplacePlayerShip({\n\t\t\t\tplayer: players.human,\n\t\t\t\tlocationArray,\n\t\t\t\tcurrentShip,\n\t\t\t\tdispatch,\n\t\t\t});\n\t\t\t// check if this is the last ship to be placed\n\t\t\tif (currentShip >= 4) {\n\t\t\t\tfadeOutMusic();\n\t\t\t\t// Computer will place ships\n\t\t\t\tplaceComputerShips(dispatch, state.players.computer.gameBoard);\n\t\t\t\tsetDismount(true);\n\t\t\t} else {\n\t\t\t\tsetCurrentShip(currentShip + 1);\n\t\t\t}\n\t\t}\n\t};\n\n\treturn (\n\t\t!loading && (\n\t\t\t<SetupWindow\n\t\t\t\tonAnimationEnd={handleAnimationEnd}\n\t\t\t\tstyle={{ animation: dismount ? 'fadeout 2s' : 'fadein 2s' }}\n\t\t\t>\n\t\t\t\t<SetupTitle>\n\t\t\t\t\t{players.human.name}, Place Your {shipTypes[currentShip].name}:\n\t\t\t\t</SetupTitle>\n\t\t\t\t<AxisButton onClick={() => setAxis(axis === 'x' ? 'y' : 'x')}>\n\t\t\t\t\tAXIS: {axis}\n\t\t\t\t</AxisButton>\n\t\t\t\t<GridOverlayContainer>\n\t\t\t\t\t{/* for ship placement */}\n\t\t\t\t\t<ShipPlacementGrid />\n\t\t\t\t\t{/* cells for click handlers */}\n\t\t\t\t\t<CellSelectorGrid\n\t\t\t\t\t\tcurrentShip={currentShip}\n\t\t\t\t\t\taxis={axis}\n\t\t\t\t\t\thandlePlaceShip={handlePlaceShip}\n\t\t\t\t\t/>\n\t\t\t\t</GridOverlayContainer>\n\t\t\t</SetupWindow>\n\t\t)\n\t);\n}\n\nexport default GameSetup;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}