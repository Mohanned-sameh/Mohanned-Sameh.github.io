{"ast":null,"code":"import _slicedToArray from\"/home/mohanned/Downloads/battleship/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useContext,useEffect,useRef,useCallback}from'react';import Init from'./Init';import GameSetup from'./GameSetup';import GameStart from'./GameStart';import WinnerScreen from'./WinnerScreen';import{store}from'../../GameController';import{MainWindow,VolumeContainer}from'../styled_components/gameControllerStyles';import music from'../../assets/sounds/music.mp3';import backgroundSound from'../../assets/sounds/background_sound.mp3';import fireShot from'../../assets/sounds/fire_shot.mp3';import shotHit from'../../assets/sounds/shot_hit.mp3';import shotMiss from'../../assets/sounds/shot_miss.mp3';import VolumeOn from'../icons/VolumeOn';import VolumeOff from'../icons/VolumeOff';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function GameWindow(){var _useContext=useContext(store),state=_useContext.state;var timeline=state.timeline,winner=state.winner;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),dismount=_useState2[0],setDismount=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),volume=_useState4[0],setVolume=_useState4[1];// pass to props to avoiding directly passing a setState function\nvar setVolumeProps=function setVolumeProps(value){value?musicPlayer.current.volume=0.5:musicPlayer.current.volume=0;setVolume(value);};var musicPlayer=useRef();// I provide two sound players so sound effects can \"overlap\"\nvar soundPlayer=useRef();var soundPlayer2=useRef();// cancel animation coming into this component\nuseEffect(function(){setDismount(false);},[setDismount]);// to avoid passing a setState directly, pass this helper function\nvar setDismountProp=function setDismountProp(state){setDismount(state);};var playBgSound=useCallback(function(sound,customVolume){if(volume){var newVol=customVolume||0.5;if(!musicPlayer.current.paused)musicPlayer.current.pause();musicPlayer.current.src=sound==='music'?music:sound==='bgSound'?backgroundSound:null;musicPlayer.current.load();musicPlayer.current.volume=newVol;musicPlayer.current.play();}},[volume]);var playSound=useCallback(function(sound,customVolume){if(volume){var newVol=customVolume||0.5;var player=soundPlayer;if(!soundPlayer.current.paused){player=soundPlayer2;}player.current.src=sound==='fireShot'?fireShot:sound==='shotMiss'?shotMiss:sound==='shotHit'?shotHit:null;player.current.load();player.current.volume=newVol;player.current.play();}},[volume]);var checkIfMusicPaused=function checkIfMusicPaused(){return musicPlayer.current.paused;};var fadeOutMusic=function fadeOutMusic(){var fadeOut=setInterval(function(){if(musicPlayer.current.volume<=0.04){musicPlayer.current.volume=0;clearInterval(fadeOut);}else{musicPlayer.current.volume=musicPlayer.current.volume-0.03;}},30);};// conditionally render based on the app state \"timeline\"\nvar renderChild=function renderChild(timeline){return timeline==='init'?/*#__PURE__*/_jsx(Init,{playBgSound:playBgSound,checkIfMusicPaused:checkIfMusicPaused,dismount:dismount,setDismount:setDismountProp}):timeline==='setup'?/*#__PURE__*/_jsx(GameSetup,{dismount:dismount,fadeOutMusic:fadeOutMusic,setDismount:setDismountProp}):winner?/*#__PURE__*/_jsx(WinnerScreen,{playBgSound:playBgSound}):!winner?/*#__PURE__*/_jsx(GameStart,{playSound:playSound,playBgSound:playBgSound,setDismount:setDismount}):null;};return/*#__PURE__*/_jsxs(MainWindow,{children:[/*#__PURE__*/_jsx(VolumeContainer,{timeline:timeline,children:volume?/*#__PURE__*/_jsx(VolumeOn,{setVolume:setVolumeProps}):/*#__PURE__*/_jsx(VolumeOff,{setVolume:setVolumeProps})}),renderChild(timeline),/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"audio\",{onEnded:function onEnded(){return musicPlayer.current.play();},ref:musicPlayer}),/*#__PURE__*/_jsx(\"audio\",{ref:soundPlayer}),/*#__PURE__*/_jsx(\"audio\",{ref:soundPlayer2})]})]});}","map":{"version":3,"names":["React","useState","useContext","useEffect","useRef","useCallback","Init","GameSetup","GameStart","WinnerScreen","store","MainWindow","VolumeContainer","music","backgroundSound","fireShot","shotHit","shotMiss","VolumeOn","VolumeOff","GameWindow","state","timeline","winner","dismount","setDismount","volume","setVolume","setVolumeProps","value","musicPlayer","current","soundPlayer","soundPlayer2","setDismountProp","playBgSound","sound","customVolume","newVol","paused","pause","src","load","play","playSound","player","checkIfMusicPaused","fadeOutMusic","fadeOut","setInterval","clearInterval","renderChild"],"sources":["/home/mohanned/Downloads/battleship/src/components/game_window/GameWindow.js"],"sourcesContent":["import React, {\n  useState,\n  useContext,\n  useEffect,\n  useRef,\n  useCallback,\n} from 'react';\nimport Init from './Init';\nimport GameSetup from './GameSetup';\nimport GameStart from './GameStart';\nimport WinnerScreen from './WinnerScreen';\nimport { store } from '../../GameController';\nimport {\n  MainWindow,\n  VolumeContainer,\n} from '../styled_components/gameControllerStyles';\nimport music from '../../assets/sounds/music.mp3';\nimport backgroundSound from '../../assets/sounds/background_sound.mp3';\nimport fireShot from '../../assets/sounds/fire_shot.mp3';\nimport shotHit from '../../assets/sounds/shot_hit.mp3';\nimport shotMiss from '../../assets/sounds/shot_miss.mp3';\nimport VolumeOn from '../icons/VolumeOn';\nimport VolumeOff from '../icons/VolumeOff';\n\nexport default function GameWindow() {\n  const { state } = useContext(store);\n  const { timeline, winner } = state;\n  const [dismount, setDismount] = useState(false);\n  const [volume, setVolume] = useState(true);\n\n  // pass to props to avoiding directly passing a setState function\n  const setVolumeProps = (value) => {\n    value\n      ? (musicPlayer.current.volume = 0.5)\n      : (musicPlayer.current.volume = 0);\n    setVolume(value);\n  };\n\n  const musicPlayer = useRef();\n  // I provide two sound players so sound effects can \"overlap\"\n  const soundPlayer = useRef();\n  const soundPlayer2 = useRef();\n\n  // cancel animation coming into this component\n  useEffect(() => {\n    setDismount(false);\n  }, [setDismount]);\n\n  // to avoid passing a setState directly, pass this helper function\n  const setDismountProp = (state) => {\n    setDismount(state);\n  };\n\n  const playBgSound = useCallback(\n    (sound, customVolume) => {\n      if (volume) {\n        const newVol = customVolume || 0.5;\n        if (!musicPlayer.current.paused) musicPlayer.current.pause();\n        musicPlayer.current.src =\n          sound === 'music'\n            ? music\n            : sound === 'bgSound'\n            ? backgroundSound\n            : null;\n        musicPlayer.current.load();\n        musicPlayer.current.volume = newVol;\n        musicPlayer.current.play();\n      }\n    },\n    [volume],\n  );\n\n  const playSound = useCallback(\n    (sound, customVolume) => {\n      if (volume) {\n        const newVol = customVolume || 0.5;\n        let player = soundPlayer;\n        if (!soundPlayer.current.paused) {\n          player = soundPlayer2;\n        }\n        player.current.src =\n          sound === 'fireShot'\n            ? fireShot\n            : sound === 'shotMiss'\n            ? shotMiss\n            : sound === 'shotHit'\n            ? shotHit\n            : null;\n        player.current.load();\n        player.current.volume = newVol;\n        player.current.play();\n      }\n    },\n    [volume],\n  );\n\n  const checkIfMusicPaused = () => {\n    return musicPlayer.current.paused;\n  };\n\n  const fadeOutMusic = () => {\n    const fadeOut = setInterval(() => {\n      if (musicPlayer.current.volume <= 0.04) {\n        musicPlayer.current.volume = 0;\n        clearInterval(fadeOut);\n      } else {\n        musicPlayer.current.volume = musicPlayer.current.volume - 0.03;\n      }\n    }, 30);\n  };\n\n  // conditionally render based on the app state \"timeline\"\n  const renderChild = (timeline) => {\n    return timeline === 'init' ? (\n      <Init\n        playBgSound={playBgSound}\n        checkIfMusicPaused={checkIfMusicPaused}\n        dismount={dismount}\n        setDismount={setDismountProp}\n      />\n    ) : timeline === 'setup' ? (\n      <GameSetup\n        dismount={dismount}\n        fadeOutMusic={fadeOutMusic}\n        setDismount={setDismountProp}\n      />\n    ) : winner ? (\n      <WinnerScreen playBgSound={playBgSound} />\n    ) : !winner ? (\n      <GameStart\n        playSound={playSound}\n        playBgSound={playBgSound}\n        setDismount={setDismount}\n      />\n    ) : null;\n  };\n\n  return (\n    <MainWindow>\n      <VolumeContainer timeline={timeline}>\n        {volume ? (\n          <VolumeOn setVolume={setVolumeProps} />\n        ) : (\n          <VolumeOff setVolume={setVolumeProps} />\n        )}\n      </VolumeContainer>\n      {renderChild(timeline)}\n      <>\n        <audio onEnded={() => musicPlayer.current.play()} ref={musicPlayer} />\n        <audio ref={soundPlayer} />\n        <audio ref={soundPlayer2} />\n      </>\n    </MainWindow>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}